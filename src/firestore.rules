/**
 * @fileoverview Firestore Security Rules for SEMAPACH dashboard data.
 *
 * Core Philosophy:
 * This ruleset makes all data publicly readable but restricts write access
 * to authenticated users. This is a common pattern for apps that display
 * public information but require a login for administrative actions.
 *
 * Data Structure:
 * - /daily_collections/{dailyCollectionId}
 * - /district_progress/{districtProgressId}
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows public read access to all daily collection data,
     * but restricts write access to authenticated users.
     * @path /daily_collections/{dailyCollectionId}
     * @allow read: if true;
     * @allow write: if isSignedIn();
     * @principle Open read access, authenticated write access.
     */
    match /daily_collections/{dailyCollectionId} {
      allow read: if true;
      allow write: if isSignedIn();
    }

    /**
     * @description Allows public read access to all district progress data,
     * but restricts write access to authenticated users.
     * @path /district_progress/{districtProgressId}
     * @allow read: if true;
     * @allow write: if isSignedIn();
     * @principle Open read access, authenticated write access.
     */
    match /district_progress/{districtProgressId} {
      allow read: if true;
      allow write: if isSignedIn();
    }

    // Helper function to determine if a user is signed in
    function isSignedIn() {
      return request.auth != null;
    }
  }
}
