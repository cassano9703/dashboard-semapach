{
  "entities": {
    "DailyCollection": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "DailyCollection",
      "type": "object",
      "description": "Represents the daily collection data for the SEMAPACH dashboard.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the daily collection record."
        },
        "date": {
          "type": "string",
          "description": "The date of the collection.",
          "format": "date"
        },
        "dailyCollectionAmount": {
          "type": "number",
          "description": "The total collection amount for the day."
        },
        "accumulatedMonthlyTotal": {
          "type": "number",
          "description": "The total collection amount accumulated for the month up to this day."
        },
        "monthlyGoal": {
          "type": "number",
          "description": "The target collection amount for the entire month."
        },
        "updatedAt": {
          "type": "string",
          "description": "The timestamp when the record was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "date",
        "dailyCollectionAmount",
        "accumulatedMonthlyTotal",
        "monthlyGoal",
        "updatedAt"
      ]
    },
    "DistrictProgress": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "DistrictProgress",
      "type": "object",
      "description": "Represents the monthly progress of each district towards their collection goals.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the district progress record, in the format YYYY-MM-DistrictName."
        },
        "month": {
          "type": "string",
          "description": "The month of the progress record, in the format YYYY-MM."
        },
        "district": {
          "type": "string",
          "description": "The name of the district (e.g., Chincha Alta, Tambo de Mora)."
        },
        "monthlyGoal": {
          "type": "number",
          "description": "The monthly collection goal for the district."
        },
        "recovered": {
          "type": "number",
          "description": "The total amount recovered by the district for the entire month."
        }
      },
      "required": [
        "month",
        "district",
        "monthlyGoal",
        "recovered"
      ]
    },
    "ClosedContract": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ClosedContract",
      "type": "object",
      "description": "Represents the monthly count of closed contracts per district.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the record."
        },
        "month": {
          "type": "string",
          "description": "The month of the record, in the format YYYY-MM."
        },
        "district": {
          "type": "string",
          "description": "The name of the district."
        },
        "quantity": {
          "type": "number",
          "description": "The number of closed contracts in the month."
        },
        "updatedAt": {
          "type": "string",
          "description": "The timestamp when the record was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "month",
        "district",
        "quantity"
      ]
    },
    "RecoveredService": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "RecoveredService",
      "type": "object",
      "description": "Represents a daily record of recovered services for a specific district.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the recovered service record."
        },
        "date": {
          "type": "string",
          "description": "The date of the recovery, in YYYY-MM-DD format.",
          "format": "date"
        },
        "district": {
          "type": "string",
          "description": "The name of the district where the service was recovered."
        },
        "recoveredCount": {
          "type": "number",
          "description": "The number of services recovered on this day in this district."
        },
        "recoveredAmount": {
          "type": "number",
          "description": "The total monetary amount recovered from these services."
        },
        "updatedAt": {
          "type": "string",
          "description": "The timestamp when the record was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "date",
        "district",
        "recoveredCount",
        "recoveredAmount"
      ]
    },
    "Recovered12Plus": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Recovered12Plus",
      "type": "object",
      "description": "Represents the daily recovery data for debts of 12 months or more (non-feasible).",
      "properties": {
        "date": {
          "type": "string",
          "description": "The date of the recovery.",
          "format": "date"
        },
        "dailyAmount": {
          "type": "number",
          "description": "The total recovery amount for the day."
        },
        "accumulatedMonthly": {
          "type": "number",
          "description": "The total recovery amount accumulated for the month up to this day."
        },
        "updatedAt": {
          "type": "string",
          "description": "The timestamp when the record was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "date",
        "dailyAmount",
        "accumulatedMonthly",
        "updatedAt"
      ]
    },
    "Recovered2to3": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Recovered2to3",
      "type": "object",
      "description": "Represents the daily recovery data for debts of 2 to 3 months (non-feasible).",
      "properties": {
        "date": {
          "type": "string",
          "description": "The date of the recovery.",
          "format": "date"
        },
        "dailyAmount": {
          "type": "number",
          "description": "The total recovery amount for the day."
        },
        "accumulatedMonthly": {
          "type": "number",
          "description": "The total recovery amount accumulated for the month up to this day."
        },
        "updatedAt": {
          "type": "string",
          "description": "The timestamp when the record was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "date",
        "dailyAmount",
        "accumulatedMonthly",
        "updatedAt"
      ]
    },
    "InspectionsAndClandestine": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "InspectionsAndClandestine",
      "type": "object",
      "description": "Represents the monthly count of inspections and clandestine connections found per district.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the record."
        },
        "month": {
          "type": "string",
          "description": "The month of the record, in the format YYYY-MM."
        },
        "district": {
          "type": "string",
          "description": "The name of the district."
        },
        "inspectionsCount": {
          "type": "number",
          "description": "The number of inspections carried out in the month."
        },
        "clandestineCount": {
          "type": "number",
          "description": "The number of clandestine connections found in the month."
        },
        "updatedAt": {
          "type": "string",
          "description": "The timestamp when the record was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "month",
        "district",
        "inspectionsCount",
        "clandestineCount"
      ]
    },
    "MonthlyGoal": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "MonthlyGoal",
      "type": "object",
      "description": "Represents a monthly goal, which can be for collection or debt recovery.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the goal record." },
        "month": { "type": "string", "description": "The month of the goal, in YYYY-MM format." },
        "goalType": { "type": "string", "enum": ["collection", "debt_3_plus"], "description": "Type of the goal." },
        "proposedAmount": { "type": "number", "description": "The proposed goal amount." },
        "executedAmount": { "type": "number", "description": "The amount executed towards the goal." },
        "amountToReach": { "type": "number", "description": "For debt goals, the target amount to reach." },
        "updatedAt": { "type": "string", "description": "Timestamp of the last update.", "format": "date-time" }
      },
      "required": ["month", "goalType", "proposedAmount"]
    },
    "ServiceOperation": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ServiceOperation",
      "type": "object",
      "description": "Represents service operations like cuts and reconnections.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the record." },
        "month": { "type": "string", "description": "The month of the operation, in YYYY-MM format." },
        "operationType": { "type": "string", "enum": ["cut", "reconnection"], "description": "Type of operation." },
        "entity": { "type": "string", "enum": ["servis", "semapach"], "description": "The entity performing the operation." },
        "quantity": { "type": "number", "description": "The number of operations performed." },
        "updatedAt": { "type": "string", "description": "Timestamp of the last update.", "format": "date-time" }
      },
      "required": ["month", "operationType", "entity", "quantity"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/daily_collections/{dailyCollectionId}",
        "definition": {
          "entityName": "DailyCollection",
          "schema": {
            "$ref": "#/backend/entities/DailyCollection"
          },
          "description": "Stores daily collection records. Includes `id` as the document ID.",
          "params": [
            {
              "name": "dailyCollectionId",
              "description": "The unique ID of the daily collection document."
            }
          ]
        }
      },
      {
        "path": "/district_progress/{districtProgressId}",
        "definition": {
          "entityName": "DistrictProgress",
          "schema": {
            "$ref": "#/backend/entities/DistrictProgress"
          },
          "description": "Stores a single monthly progress record for each district. The document ID is generated by Firestore.",
          "params": [
            {
              "name": "districtProgressId",
              "description": "The unique ID of the district progress document."
            }
          ]
        }
      },
      {
        "path": "/recovered_services/{recoveredServiceId}",
        "definition": {
          "entityName": "RecoveredService",
          "schema": {
            "$ref": "#/backend/entities/RecoveredService"
          },
          "description": "Stores daily records of recovered services. The document ID is generated by Firestore.",
          "params": [
            {
              "name": "recoveredServiceId",
              "description": "The unique ID of the recovered service document."
            }
          ]
        }
      },
      {
        "path": "/recovered_12_plus/{recovered12PlusId}",
        "definition": {
          "entityName": "Recovered12Plus",
          "schema": {
            "$ref": "#/backend/entities/Recovered12Plus"
          },
          "description": "Stores daily records for recovered debts of 12+ months. The document ID is generated by Firestore.",
          "params": [
            {
              "name": "recovered12PlusId",
              "description": "The unique ID of the recovered 12+ month debt record."
            }
          ]
        }
      },
      {
        "path": "/recovered_2_to_3/{recovered2to3Id}",
        "definition": {
          "entityName": "Recovered2to3",
          "schema": {
            "$ref": "#/backend/entities/Recovered2to3"
          },
          "description": "Stores daily records for recovered debts of 2 to 3 months. The document ID is generated by Firestore.",
          "params": [
            {
              "name": "recovered2to3Id",
              "description": "The unique ID of the recovered 2-3 month debt record."
            }
          ]
        }
      },
      {
        "path": "/inspections_clandestine/{recordId}",
        "definition": {
          "entityName": "InspectionsAndClandestine",
          "schema": {
            "$ref": "#/backend/entities/InspectionsAndClandestine"
          },
          "description": "Stores monthly records of inspections and clandestine connections per district. The document ID is generated by Firestore.",
          "params": [
            {
              "name": "recordId",
              "description": "The unique ID of the inspections and clandestine record."
            }
          ]
        }
      },
      {
        "path": "/closed_contracts/{contractId}",
        "definition": {
          "entityName": "ClosedContract",
          "schema": {
            "$ref": "#/backend/entities/ClosedContract"
          },
          "description": "Stores monthly records of closed contracts per district. The document ID is generated by Firestore.",
          "params": [
            {
              "name": "contractId",
              "description": "The unique ID of the closed contract record."
            }
          ]
        }
      },
      {
        "path": "/monthly_goals/{goalId}",
        "definition": {
          "entityName": "MonthlyGoal",
          "schema": { "$ref": "#/backend/entities/MonthlyGoal" },
          "description": "Stores monthly goals for collection or debt recovery.",
          "params": [{ "name": "goalId", "description": "The unique ID of the monthly goal document." }]
        }
      },
      {
        "path": "/service_operations/{operationId}",
        "definition": {
          "entityName": "ServiceOperation",
          "schema": { "$ref": "#/backend/entities/ServiceOperation" },
          "description": "Stores records of service operations like cuts and reconnections.",
          "params": [{ "name": "operationId", "description": "The unique ID of the service operation document." }]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to store daily collection data, monthly district progress, and daily recovered services for the SEMAPACH dashboard. Authorization Independence is not a major concern as there is no user-specific data, and security will likely be role-based. The collections are segregated to avoid mixing different data types and to facilitate secure and efficient querying (QAPs). This segregation ensures that listing daily collections doesn't inadvertently expose district progress or recovered services data, and vice versa. The paths are straightforward to facilitate easy data access and manipulation, prioritizing clarity for front-end integration and reporting."
  }
}
